hosts -- Файл с узлами, заполняется записями вида "kafka-1 ansible_host=192.168.122.142.xip.io node_id=1".
kafka_cluster.yml -- Плейбук установки и изменения кластера.

Примеры использования:
ansible-playbook -i hosts kafka_cluster.yml -- Запустить установку на все узлы из группы kafka в перечисленные в файле hosts. Если на каких-то хостах kafka уже установленна, они будут пропущенны, а установка будет проиведена на остальные.
ansible-playbook -i hosts kafka_cluster.yml --tags clean -- Вычищает данные и все вайлы кафки и зукипера, после чего нода готова для повторой конфигурации. 
ansible-playbook -i hosts kafka_cluster.yml --tags reconfigure -- Не трогает данные и бинарники, но перегенерирует конфиги и скрипты с учетом изменений в плейбуке, после чего рестартит сервисы.
ansible-playbook -i hosts kafka_cluster.yml --tags restart -- Просто рестарт кафки на всех нодах.
Прокси можно указать прямо при запуске, не изменяя конфигов:
ansible-playbook -i hosts kafka_cluster.yml --extra-vars '{"proxy_env": {"http_proxy": "http://192.168.122.1:8888", "https_proxy": "http://192.168.122.1:8888"}}'

Структура папки с ролями:
В каталоге с плейбукао есть папка Roles, где хранятся данные о ролях, разложеные по подпапкам (в нашем случае epel, basic_centos, и kafka_node_centos). Рассмотрим структуру роли на примере kafka_node_centos:
tasks -- Непосредственно задания, запускается main.yml, из него могут вызыватся другие файлы с заданиями
vars -- Файлы переменных, указанные здесь значения имеют один из самых высоких приоритетов, если переменная задана несколькими способами, к примеру перезатрет значение, заданное в файле инвентаризации.
defaults -- Тоже файлы переменных, но имеет наинизший приоритет, при необходимости любую переменную можно переопределить любым способом. 
handlers -- Обработчики, т.е. задачи которые могут выполнятся при успешном завершении какой-либо задачи.
files -- Папка для файлов, которые передаются на хосты в неизменном виде.
templates -- Папка для шаблонов конфигурационных файлов, могут содежать переменные и логику.
meta -- Зависимости этой роли, от других ролей.

В этом примере, чтобы править переменные общие для вех хостов, мы пойдем в roles/kafka_node_centos/defaults/main.yml
Чтобы править конфиги -- в roles/kafka_node_centos/templates/
